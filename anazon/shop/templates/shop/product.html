{% extends 'main.html' %}
{% block content %}
<div>
    <form method="GET" action="{% url 'product' %}">
        <input type="text" name="search" placeholder="Search Product"/>
    </form>
</div>

<div>
    <a href="{% url 'product' %}">All</a>
    {% for category in categories %}
    <a href="{% url 'product' %}?tag={{category.name}}" >{{category.name}}</a>
    {% endfor %}
</div>

<div>
    {% for tag in tags %}
    <a href="{% url 'product' %}?search={{request.GET.search}}&tag={{tag.name}}" >{{tag.name}}</a>
    {% endfor %}
</div>


    <div class="text-center container py-5">
      <div class="row">
        {% for product in products|slice:":3" %}
        <div class="col-lg-4 col-md-12 mb-4">
          <a href="{% url 'product_detail' product.pk %}">
          <div class="card h-100 w-100 shadow">
            <div class="bg-image hover-zoom ripple ripple-surface ripple-surface-light"
              data-mdb-ripple-color="light">
              <img height="500" src="{{product.image}}"
                class="w-100" />
            </div>
            <div class="card-body d-flex flex-column justify-content-between">
              <h5 class="card-title">{{product.title}}</h5>
              <p class="card-text">${{product.price}}</p>
            </div>
          </div>
          </a>
        </div> 
        {% endfor %}
      </div>
      <div class="row">
        {% for product in products|slice:"3:6" %}
        <div class="col-lg-4 col-md-12 mb-4">
          <a href="{% url 'product_detail' product.pk %}">
          <div class="card h-100 w-100 shadow">
            <div class="bg-image hover-zoom ripple ripple-surface ripple-surface-light"
              data-mdb-ripple-color="light">
              <img height="500" src="{{product.image}}"
                class="w-100" />
            </div>
            <div class="card-body d-flex flex-column justify-content-between">
                <h5 class="card-title">{{product.title}}</h5>
                <p class="card-text">${{product.price}}</p>
            </div>
          </div>
          </a>
        </div> 
        {% endfor %}
      </div>
      <div class="row">
        {% for product in products|slice:"6:9" %}
        <div class="col-lg-4 col-md-12 mb-4">
          <a href="{% url 'product_detail' product.pk %}">
          <div class="card h-100 w-100 shadow">
            <div class="bg-image hover-zoom ripple ripple-surface ripple-surface-light"
              data-mdb-ripple-color="light">
              <img height="500" src="{{product.image}}"
                class="w-100" />
            </div>
            <div class="card-body d-flex flex-column justify-content-between">
                <h5 class="card-title">{{product.title}}</h5>
                <p class="card-text">${{product.price}}</p>
            </div>
          </div>
          </a>
        </div> 
        {% endfor %}
      </div>
    </div>

    <ul class="pagination">
        {% if products.has_previous %}
            <li class="page-item">
                <a class="page-link" href="{% url 'product' %}?search={{request.GET.search}}&tag={{request.GET.tag}}&page={{ page_obj.previous_page_number }}" aria-label="Previous">
                  <span aria-hidden="true">&laquo;</span>
                  <span class="sr-only">Previous</span>
                </a>
            </li>
        {% endif %}

        {% if products.number|add:'-4' > 1 %}
            <li class="page-item"><a class="page-link" href="{% url 'product' %}?search={{request.GET.search}}&tag={{request.GET.tag}}&page={{ page_obj.number|add:'-5' }}">&hellip;</a></li>
        {% endif %}

        {% for i in products.paginator.page_range %}
            {% if products.number == i %}
                <li class="page-item disabled"><a class="page-link">{{i}}</a></li>
            {% elif i > products.number|add:'-5' and i < products.number|add:'5' %}
                <li class="page-item"><a class="page-link" href="{% url 'product' %}?search={{request.GET.search}}&tag={{request.GET.tag}}&page={{ i }}">{{ i }}</a></li>
            {% endif %}
        {% endfor %}

        {% if products.paginator.num_pages > products.number|add:'4' %}
            <li class="page-item"><a class="page-link" href="{% url 'product' %}?search={{request.GET.search}}&tag={{request.GET.tag}}&page={{ products.number|add:'5' }}">&hellip;</a></li>
        {% endif %}

        {% if products.has_next %}
            <li class="page-item">
                <a class="page-link" href="{% url 'product' %}?search={{request.GET.search}}&tag={{request.GET.tag}}&page={{ products.next_page_number }}" aria-label="Next">
                  <span class="sr-only">Next</span>
                  <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        {% endif %}
    </ul>
</div>
{% endblock content %}